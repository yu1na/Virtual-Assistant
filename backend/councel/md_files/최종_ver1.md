# Virtual Assistant ì „ì²´ ì‹œìŠ¤í…œ íë¦„ë„ ë° ê¸°ëŠ¥ ì„¤ëª…

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì „ì²´ íë¦„ë„](#ì „ì²´-íë¦„ë„)
3. [ì„œë²„ ì‹œì‘ í”„ë¡œì„¸ìŠ¤](#ì„œë²„-ì‹œì‘-í”„ë¡œì„¸ìŠ¤)
4. [ì‚¬ìš©ì ìš”ì²­ ì²˜ë¦¬ íë¦„](#ì‚¬ìš©ì-ìš”ì²­-ì²˜ë¦¬-íë¦„)
5. [ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ì„¤ëª…](#ì£¼ìš”-ì»´í¬ë„ŒíŠ¸-ìƒì„¸-ì„¤ëª…)
6. [íŒŒì¼ êµ¬ì¡° ë° ì—­í• ](#íŒŒì¼-êµ¬ì¡°-ë°-ì—­í• )

---

## ì‹œìŠ¤í…œ ê°œìš”

Virtual AssistantëŠ” **Multi-Agent ê¸°ë°˜ RAG ìƒë‹´ ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤.

- **ë°±ì—”ë“œ**: FastAPI ê¸°ë°˜ REST API ì„œë²„
- **í”„ë¡ íŠ¸ì—”ë“œ**: Electron ê¸°ë°˜ ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜
- **í•µì‹¬ ê¸°ëŠ¥**: 
  - Multi-Agent Supervisorë¥¼ í†µí•œ ìë™ ë¼ìš°íŒ…
  - RAG ê¸°ë°˜ ì•„ë“¤ëŸ¬ ì‹¬ë¦¬ ìƒë‹´
  - Vector DB ê¸°ë°˜ ì§€ì‹ ê²€ìƒ‰
  - Self-learning ê¸°ëŠ¥

---

## ì „ì²´ íë¦„ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì„œë²„ ì‹œì‘ (main.py)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. FastAPI ì•± ìƒì„±                                        â”‚ â”‚
â”‚  â”‚ 2. lifespan í•¨ìˆ˜ ì‹¤í–‰                                     â”‚ â”‚
â”‚  â”‚ 3. ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±                                â”‚ â”‚
â”‚  â”‚ 4. automatic_save() í˜¸ì¶œ                                  â”‚ â”‚
â”‚  â”‚    â”œâ”€ Step 1: ì²­í¬ íŒŒì¼ ìƒì„±                              â”‚ â”‚
â”‚  â”‚    â”œâ”€ Step 2: ì„ë² ë”© íŒŒì¼ ìƒì„±                           â”‚ â”‚
â”‚  â”‚    â””â”€ Step 3: Vector DB ì €ì¥                              â”‚ â”‚
â”‚  â”‚ 5. ì„œë²„ ì¤€ë¹„ ì™„ë£Œ                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì‚¬ìš©ì ì…ë ¥ (í”„ë¡ íŠ¸ì—”ë“œ)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ chatPanel.js                                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ handleSendMessage()                                  â”‚ â”‚
â”‚  â”‚  â””â”€ ì‚¬ìš©ì ë©”ì‹œì§€ UIì— ì¶”ê°€                              â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚ chatService.js                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ callChatModule()                                     â”‚ â”‚
â”‚  â”‚  â””â”€ Multi-Agent API í˜¸ì¶œ                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Multi-Agent Supervisor (ë°±ì—”ë“œ)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ POST /api/v1/multi-agent/query                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ multi_agent.py: multi_agent_query()                  â”‚ â”‚
â”‚  â”‚  â””â”€ SupervisorAgent.process()                             â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚ SupervisorAgent (supervisor.py)                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ ì‚¬ìš©ì ì§ˆë¬¸ ë¶„ì„                                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ í‚¤ì›Œë“œ ê¸°ë°˜ ì—ì´ì „íŠ¸ ì„ íƒ                             â”‚ â”‚
â”‚  â”‚  â””â”€ ì ì ˆí•œ Tool í˜¸ì¶œ                                      â”‚ â”‚
â”‚  â”‚     â”œâ”€ chatbot_tool                                      â”‚ â”‚
â”‚  â”‚     â”œâ”€ rag_tool                                          â”‚ â”‚
â”‚  â”‚     â”œâ”€ brainstorming_tool                                 â”‚ â”‚
â”‚  â”‚     â”œâ”€ planner_tool                                      â”‚ â”‚
â”‚  â”‚     â”œâ”€ report_tool                                       â”‚ â”‚
â”‚  â”‚     â””â”€ therapy_tool â† (ìƒë‹´ ê´€ë ¨ ì§ˆë¬¸ ì‹œ)                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Therapy Agent (ìƒë‹´ ì—ì´ì „íŠ¸)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ therapy_tool (agent_tools.py)                            â”‚ â”‚
â”‚  â”‚  â””â”€ TherapyAgent.process()                               â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚ TherapyAgent (therapy_agent.py)                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ TherapyService.is_available() í™•ì¸                   â”‚ â”‚
â”‚  â”‚  â””â”€ TherapyService.chat() í˜¸ì¶œ                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Therapy Service (ì„œë¹„ìŠ¤ ë ˆì´ì–´)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ TherapyService (service.py)                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ RAGTherapySystem ì´ˆê¸°í™” (ìµœì´ˆ 1íšŒ)                   â”‚ â”‚
â”‚  â”‚  â””â”€ RAGTherapySystem.chat() í˜¸ì¶œ                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        RAG Therapy System (rag_therapy.py)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ RAGTherapySystem.chat()                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ 1. ì¢…ë£Œ í‚¤ì›Œë“œ í™•ì¸                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ 2. ì…ë ¥ ë¶„ë¥˜ (adler/counseling/general)              â”‚ â”‚
â”‚  â”‚  â”œâ”€ 3. ì˜ì–´ ë²ˆì—­ (Vector DB ê²€ìƒ‰ìš©)                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ 4. Multi-step ê²€ìƒ‰                                    â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ SearchEngine._iterative_search_with_query_expansion() â”‚
â”‚  â”‚  â”‚   â”œâ”€ ì´ˆê¸° ê²€ìƒ‰                                        â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ í’ˆì§ˆ í‰ê°€                                        â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ ì¿¼ë¦¬ í™•ì¥ (í•„ìš” ì‹œ)                              â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ ì¬ê²€ìƒ‰                                           â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€ Re-ranker ì ìš©                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ 5. ìµœê³  ìœ ì‚¬ë„ ê³„ì‚°                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ 6. Threshold ë¶„ê¸° (0.7 ê¸°ì¤€)                         â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ [ìœ ì‚¬ë„ â‰¥ 0.7] LLM ë‹¨ë… ë‹µë³€                     â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€ [ìœ ì‚¬ë„ < 0.7] RAG + Self-learning               â”‚ â”‚
â”‚  â”‚  â”œâ”€ 7. ë‹µë³€ ìƒì„±                                          â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€ LLM ë‹¨ë…: ResponseGenerator._generate_llm_only_response() â”‚
â”‚  â”‚  â”‚   â””â”€ RAG ê¸°ë°˜: ResponseGenerator.generate_response_with_persona() â”‚
â”‚  â”‚  â”œâ”€ 8. Self-learning (ì¡°ê±´ë¶€)                            â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€ _save_qa_to_vectordb()                          â”‚ â”‚
â”‚  â”‚  â””â”€ 9. ëŒ€í™” íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ì‘ë‹µ ë°˜í™˜ ê²½ë¡œ                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ RAGTherapySystem â†’ TherapyService â†’ TherapyAgent         â”‚ â”‚
â”‚  â”‚ â†’ SupervisorAgent â†’ multi_agent.py                      â”‚ â”‚
â”‚  â”‚ â†’ chatService.js â†’ chatPanel.js                          â”‚ â”‚
â”‚  â”‚ â†’ UIì— ë©”ì‹œì§€ í‘œì‹œ                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì„œë²„ ì‹œì‘ í”„ë¡œì„¸ìŠ¤

### 1. ì„œë²„ ì‹œì‘ ìˆœì„œ

**íŒŒì¼**: `backend/app/main.py`

```
1. FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±
   â†“
2. lifespan í•¨ìˆ˜ ì‹¤í–‰ (ì„œë²„ ì‹œì‘ ì‹œ)
   â”œâ”€ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±
   â””â”€ automatic_save() í˜¸ì¶œ
      â†“
3. Vector DB ìë™ ìƒì„± í”„ë¡œì„¸ìŠ¤
   â”œâ”€ Step 1: ì²­í¬ íŒŒì¼ ìƒì„±
   â”œâ”€ Step 2: ì„ë² ë”© íŒŒì¼ ìƒì„±
   â””â”€ Step 3: Vector DB ì €ì¥
   â†“
4. ì„œë²„ ì¤€ë¹„ ì™„ë£Œ
```

### 2. automatic_save() í”„ë¡œì„¸ìŠ¤ ìƒì„¸

**íŒŒì¼**: `backend/councel/sourcecode/automatic_save.py`

#### AutomaticSaveManager í´ë˜ìŠ¤

**ì—­í• **: PDF íŒŒì¼ì„ Vector DBë¡œ ë³€í™˜í•˜ëŠ” ì „ì²´ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬

**ì£¼ìš” ë©”ì„œë“œ**:

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `step1_create_chunks()` | PDF íŒŒì¼ì„ ì²­í¬ë¡œ ë¶„í• í•˜ì—¬ JSON íŒŒì¼ ìƒì„± |
| `step2_create_embeddings()` | ì²­í¬ íŒŒì¼ì— ëŒ€í•œ ì„ë² ë”© ìƒì„± |
| `step3_save_to_vectordb()` | ì„ë² ë”©ì„ ChromaDBì— ì €ì¥ |
| `run()` | ì „ì²´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ |

#### Step 1: ì²­í¬ íŒŒì¼ ìƒì„±

**íŒŒì¼**: `backend/councel/sourcecode/automatic_save/create_chunk_files.py`

**ê¸°ëŠ¥**: PDF íŒŒì¼ì„ Parent-Child êµ¬ì¡°ë¡œ ì²­í‚¹

**ì²˜ë¦¬ ê³¼ì •**:
```
PDF íŒŒì¼ ì½ê¸° (PyMuPDF)
  â†“
í…ìŠ¤íŠ¸ ì¶”ì¶œ ë° ì •ì œ
  â”œâ”€ í˜ì´ì§€ ë²ˆí˜¸ ì œê±°
  â”œâ”€ í‘œ/ê·¸ë˜í”„ íŠ¹ìˆ˜ë¬¸ì ì œê±°
  â”œâ”€ ì°¸ê³ ë¬¸í—Œ ì„¹ì…˜ ì œê±°
  â””â”€ ê³µë°± ì •ë¦¬
  â†“
Parent-Child ì²­í‚¹
  â”œâ”€ Parent: 1000 tokens
  â””â”€ Child: 500 tokens (overlap 20%)
  â†“
ë©”íƒ€ë°ì´í„° ì¶”ê°€
  â”œâ”€ source: íŒŒì¼ëª…
  â”œâ”€ chunk_type: "parent" ë˜ëŠ” "child"
  â”œâ”€ parent_id: Parent ì²­í¬ ID (Childë§Œ)
  â””â”€ page_number: í˜ì´ì§€ ë²ˆí˜¸
  â†“
JSON íŒŒì¼ë¡œ ì €ì¥ (*_chunks.json)
```

#### Step 2: ì„ë² ë”© ìƒì„±

**íŒŒì¼**: `backend/councel/sourcecode/automatic_save/create_openai_embeddings.py`

**ê¸°ëŠ¥**: ì²­í¬ íŒŒì¼ì˜ í…ìŠ¤íŠ¸ë¥¼ ì„ë² ë”© ë²¡í„°ë¡œ ë³€í™˜

**ì²˜ë¦¬ ê³¼ì •**:
```
ì²­í¬ íŒŒì¼ ë¡œë“œ (*_chunks.json)
  â†“
ë°°ì¹˜ ë‹¨ìœ„ë¡œ ì„ë² ë”© ìƒì„±
  â”œâ”€ ëª¨ë¸: text-embedding-3-large
  â”œâ”€ ë°°ì¹˜ í¬ê¸°: 100ê°œ
  â””â”€ OpenAI API í˜¸ì¶œ
  â†“
ì„ë² ë”©ì„ ì²­í¬ì— ì¶”ê°€
  â†“
JSON íŒŒì¼ë¡œ ì €ì¥ (*_embeddings.json)
```

#### Step 3: Vector DB ì €ì¥

**íŒŒì¼**: `backend/councel/sourcecode/automatic_save/save_to_vectordb.py`

**ê¸°ëŠ¥**: ì„ë² ë”© íŒŒì¼ì„ ChromaDBì— ì €ì¥

**ì²˜ë¦¬ ê³¼ì •**:
```
ChromaDB í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
  â†“
ì»¬ë ‰ì…˜ ìƒì„± ë˜ëŠ” ê°€ì ¸ì˜¤ê¸°
  â”œâ”€ ì»¬ë ‰ì…˜ëª…: "vector_adler"
  â””â”€ ê±°ë¦¬ í•¨ìˆ˜: cosine (ì½”ì‚¬ì¸ ìœ ì‚¬ë„)
  â†“
ì„ë² ë”© íŒŒì¼ ë¡œë“œ
  â†“
ê¸°ì¡´ ID í™•ì¸ (ì¤‘ë³µ ë°©ì§€)
  â†“
ë°°ì¹˜ ë‹¨ìœ„ë¡œ ì €ì¥ (ë°°ì¹˜ í¬ê¸°: 1000)
  â”œâ”€ ids: ê³ ìœ  ID
  â”œâ”€ embeddings: ì„ë² ë”© ë²¡í„°
  â”œâ”€ documents: ì›ë³¸ í…ìŠ¤íŠ¸
  â””â”€ metadatas: ë©”íƒ€ë°ì´í„°
  â†“
ì €ì¥ ì™„ë£Œ
```

---

## ì‚¬ìš©ì ìš”ì²­ ì²˜ë¦¬ íë¦„

### ì „ì²´ íë¦„ ìƒì„¸

#### 1ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œ ì…ë ¥ ì²˜ë¦¬

**íŒŒì¼**: `renderer/chat/chatPanel.js`

**ì²˜ë¦¬ ë‚´ìš©**:
1. ì‚¬ìš©ìê°€ ì…ë ¥ì°½ì— ë©”ì‹œì§€ ì…ë ¥
2. Enter í‚¤ ë˜ëŠ” ì „ì†¡ ë²„íŠ¼ í´ë¦­
3. `handleSendMessage()` í•¨ìˆ˜ ì‹¤í–‰
4. ì‚¬ìš©ì ë©”ì‹œì§€ë¥¼ UIì— ì¦‰ì‹œ í‘œì‹œ
5. `callChatModule()` í˜¸ì¶œ

**ì£¼ìš” í•¨ìˆ˜**:
- `handleSendMessage()`: ë©”ì‹œì§€ ì „ì†¡ ì²˜ë¦¬
- `addMessage()`: ì¼ë°˜ ë©”ì‹œì§€ UI ì¶”ê°€
- `addTherapyMessage()`: ìƒë‹´ ë©”ì‹œì§€ UI ì¶”ê°€

#### 2ë‹¨ê³„: Multi-Agent API í˜¸ì¶œ

**íŒŒì¼**: `renderer/chat/chatService.js`

**ì²˜ë¦¬ ë‚´ìš©**:
1. Multi-Agent ì„¸ì…˜ ID ê°€ì ¸ì˜¤ê¸° (ì—†ìœ¼ë©´ ìƒì„±)
2. `POST /api/v1/multi-agent/query` í˜¸ì¶œ
3. ì‚¬ìš©ì ì§ˆë¬¸ ì „ì†¡

**ì£¼ìš” í•¨ìˆ˜**:
- `callChatModule(userText)`: ë©”ì¸ ë¼ìš°íŒ… í•¨ìˆ˜
- `getOrCreateMultiAgentSession()`: ì„¸ì…˜ ID ê´€ë¦¬

#### 3ë‹¨ê³„: Multi-Agent Supervisor ì²˜ë¦¬

**íŒŒì¼**: `backend/app/api/v1/endpoints/multi_agent.py`

**ì²˜ë¦¬ ë‚´ìš©**:
1. `multi_agent_query()` ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ìš”ì²­ ìˆ˜ì‹ 
2. `SupervisorAgent.process()` í˜¸ì¶œ

**íŒŒì¼**: `backend/multi_agent/supervisor.py`

**SupervisorAgent ì—­í• **:
1. ì‚¬ìš©ì ì§ˆë¬¸ ë¶„ì„
2. í‚¤ì›Œë“œ ê¸°ë°˜ ì—ì´ì „íŠ¸ ì„ íƒ
3. ì ì ˆí•œ Tool í˜¸ì¶œ

**ì—ì´ì „íŠ¸ ì„ íƒ ë¡œì§**:
- **chatbot_tool**: ì¼ë°˜ ëŒ€í™”, ì¸ì‚¬, ì¡ë‹´
- **rag_tool**: íšŒì‚¬ ë¬¸ì„œ, ê·œì •, ì •ì±… ê²€ìƒ‰
- **brainstorming_tool**: ì°½ì˜ì  ì•„ì´ë””ì–´, ë¸Œë ˆì¸ìŠ¤í† ë°
- **planner_tool**: ì¼ì • ê´€ë¦¬, ê³„íš ìˆ˜ë¦½
- **report_tool**: ë¦¬í¬íŠ¸ ìƒì„±, ì‹¤ì  ë¶„ì„
- **therapy_tool**: ì‹¬ë¦¬ ìƒë‹´, ì •ì‹  ê±´ê°• ì§€ì› â† **ìƒë‹´ ê´€ë ¨ ì§ˆë¬¸ ì‹œ**

#### 4ë‹¨ê³„: Therapy Agent ì²˜ë¦¬

**íŒŒì¼**: `backend/multi_agent/tools/agent_tools.py`

**ì²˜ë¦¬ ë‚´ìš©**:
1. `therapy_tool` í•¨ìˆ˜ í˜¸ì¶œ
2. `TherapyAgent.process()` ì‹¤í–‰

**íŒŒì¼**: `backend/multi_agent/agents/therapy_agent.py`

**TherapyAgent ì—­í• **:
1. `TherapyService.is_available()` í™•ì¸
2. `TherapyService.chat()` í˜¸ì¶œ

#### 5ë‹¨ê³„: Therapy Service ì²˜ë¦¬

**íŒŒì¼**: `backend/app/domain/therapy/service.py`

**TherapyService ì—­í• **:
1. ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
2. `RAGTherapySystem` ì´ˆê¸°í™” (ìµœì´ˆ 1íšŒ)
3. `RAGTherapySystem.chat()` í˜¸ì¶œ

#### 6ë‹¨ê³„: RAG Therapy System ì²˜ë¦¬

**íŒŒì¼**: `backend/councel/sourcecode/persona/rag_therapy.py`

**RAGTherapySystem.chat() ì²˜ë¦¬ ë‹¨ê³„**:

**1. ì¢…ë£Œ í‚¤ì›Œë“œ í™•ì¸**
- í‚¤ì›Œë“œ: "exit", "ê³ ë§ˆì›Œ", "ë"
- ì¢…ë£Œ ë©”ì‹œì§€ ë°˜í™˜

**2. ì…ë ¥ ë¶„ë¥˜**
- `ResponseGenerator.classify_input()`
- ë°˜í™˜: "adler" / "counseling" / "general"

**3. ì˜ì–´ ë²ˆì—­**
- `SearchEngine.translate_to_english()`
- Vector DB ê²€ìƒ‰ìš© ì˜ì–´ ì¿¼ë¦¬ ìƒì„±

**4. Multi-step ê²€ìƒ‰**
- `SearchEngine._iterative_search_with_query_expansion()`
- ìµœëŒ€ 2íšŒ ë°˜ë³µ (ì´ˆê¸° ê²€ìƒ‰ + ì¿¼ë¦¬ í™•ì¥ ê²€ìƒ‰)
- í’ˆì§ˆ í‰ê°€ ë° ê°œì„ 

**5. ìœ ì‚¬ë„ ê³„ì‚°**
- ê²€ìƒ‰ëœ ì²­í¬ë“¤ì˜ ìµœê³  ìœ ì‚¬ë„ ì¶”ì¶œ
- ê°ì • ê°€ì¤‘ì¹˜ ì ìš©ëœ `final_similarity` ì‚¬ìš©

**6. Threshold ë¶„ê¸° (0.7 ê¸°ì¤€)**
- **Case A**: ìœ ì‚¬ë„ â‰¥ 0.7
  - LLM ë‹¨ë… ëª¨ë“œ
  - RAG ì—†ì´ í˜ë¥´ì†Œë‚˜ ê¸°ë°˜ ë‹µë³€
- **Case B**: ìœ ì‚¬ë„ < 0.7
  - RAG ëª¨ë“œ
  - ê²€ìƒ‰ëœ ì²­í¬ë¥¼ ì»¨í…ìŠ¤íŠ¸ë¡œ í™œìš©
  - Self-learning ì‹¤í–‰

**7. ë‹µë³€ ìƒì„±**
- LLM ë‹¨ë…: `ResponseGenerator._generate_llm_only_response()`
- RAG ê¸°ë°˜: `ResponseGenerator.generate_response_with_persona()`

**8. Self-learning (ì¡°ê±´ë¶€)**
- ìµœê³  ìœ ì‚¬ë„ < 0.7ì¼ ë•Œ ì‹¤í–‰
- `_save_qa_to_vectordb()`: Q&Aë¥¼ Vector DBì— ì €ì¥

**9. ëŒ€í™” íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸**
- ìµœëŒ€ 10ê°œ ëŒ€í™” ìœ ì§€
- ì˜¤ë˜ëœ ëŒ€í™” ìë™ ì œê±°

#### 7ë‹¨ê³„: ê²€ìƒ‰ í”„ë¡œì„¸ìŠ¤ ìƒì„¸

**íŒŒì¼**: `backend/councel/sourcecode/persona/search_engine.py`

**Multi-step ê²€ìƒ‰ íë¦„**:
```
ì´ˆê¸° ê²€ìƒ‰
  â”œâ”€ ì„ë² ë”© ìƒì„± (text-embedding-3-large)
  â”œâ”€ Vector DB ê²€ìƒ‰ (n_results=5)
  â””â”€ í’ˆì§ˆ í‰ê°€
      â”œâ”€ í‰ê·  ìœ ì‚¬ë„ ê³„ì‚°
      â”œâ”€ ë‹¤ì–‘ì„± ì ìˆ˜ ê³„ì‚° (ì„œë¡œ ë‹¤ë¥¸ ì†ŒìŠ¤ ë¹„ìœ¨)
      â””â”€ ì¢…í•© í’ˆì§ˆ ì ìˆ˜ (í‰ê·  ìœ ì‚¬ë„ 70% + ë‹¤ì–‘ì„± 30%)
      â†“
[í’ˆì§ˆ ì ìˆ˜ < 0.6ì´ë©´ ê°œì„  ì‹œë„]
  â”œâ”€ ì¿¼ë¦¬ í™•ì¥ (LLM ê¸°ë°˜)
  â”‚   â”œâ”€ í•µì‹¬ ê°ì •/ì‹¬ë¦¬ ìƒíƒœ ì¶”ì¶œ
  â”‚   â”œâ”€ ì•„ë“¤ëŸ¬ ê°œë… ì—°ê²°
  â”‚   â””â”€ ìœ ì‚¬í•œ ìƒí™© í‚¤ì›Œë“œ ìƒì„±
  â”œâ”€ í™•ì¥ëœ ì¿¼ë¦¬ë¡œ ì¬ê²€ìƒ‰
  â””â”€ ê²°ê³¼ ë³‘í•©
      â†“
Re-ranker ì ìš©
  â”œâ”€ LLM ê¸°ë°˜ ê´€ë ¨ì„± í‰ê°€
  â””â”€ ì¬ì •ë ¬
      â†“
ìµœì¢… ìƒìœ„ 5ê°œ ì²­í¬ ë°˜í™˜
```

#### 8ë‹¨ê³„: ë‹µë³€ ìƒì„± í”„ë¡œì„¸ìŠ¤

**íŒŒì¼**: `backend/councel/sourcecode/persona/response_generator.py`

**LLM ë‹¨ë… ëª¨ë“œ**:
1. í˜ë¥´ì†Œë‚˜ í”„ë¡¬í”„íŠ¸ ë¡œë“œ
2. ëŒ€í™” íˆìŠ¤í† ë¦¬ ì¶”ê°€ (ìµœê·¼ 3ê°œ)
3. ê°ì • ë§¥ë½ ì¶”ì¶œ
4. 3ë‹¨ê³„ êµ¬ì¡° ê°•ì œ í”„ë¡¬í”„íŠ¸
5. OpenAI API í˜¸ì¶œ (gpt-4o-mini)

**RAG ê¸°ë°˜ ëª¨ë“œ**:
1. ê²€ìƒ‰ëœ ì²­í¬ë¥¼ ì»¨í…ìŠ¤íŠ¸ë¡œ êµ¬ì„± (ìƒìœ„ 3ê°œ)
2. í˜ë¥´ì†Œë‚˜ í”„ë¡¬í”„íŠ¸ ì ìš©
3. ëŒ€í™” íˆìŠ¤í† ë¦¬ ì¶”ê°€ (ìµœê·¼ 10ê°œ)
4. ê°ì • í‚¤ì›Œë“œ ê°ì§€ ë° ë°˜ì˜
5. 3ë‹¨ê³„ êµ¬ì¡° í”„ë¡¬í”„íŠ¸:
   - 1ë‹¨ê³„: ê°ì • ì¸ì • (1ë¬¸ì¥)
   - 2ë‹¨ê³„: ì•„ë“¤ëŸ¬ ê´€ì  ì¬í•´ì„ (1ë¬¸ì¥)
   - 3ë‹¨ê³„: ê²©ë ¤ ë° ì‹¤ì²œ ë°©ì•ˆ (1~2ë¬¸ì¥)
6. OpenAI API í˜¸ì¶œ (gpt-4o-mini, max_tokens=250)

#### 9ë‹¨ê³„: Self-learning

**íŒŒì¼**: `backend/councel/sourcecode/persona/rag_therapy.py`

**ì¡°ê±´**: ìµœê³  ìœ ì‚¬ë„ < 0.7ì¼ ë•Œ ì‹¤í–‰

**ì²˜ë¦¬ ê³¼ì •**:
1. ì‚¬ìš©ì ì§ˆë¬¸ê³¼ LLM ë‹µë³€ì„ JSON ë¬¸ì„œë¡œ êµ¬ì„±
2. ì‚¬ìš©ì ì§ˆë¬¸ì— ëŒ€í•œ ì„ë² ë”© ìƒì„±
3. Vector DBì— ì €ì¥
   - ID: `self_learning_{uuid}`
   - ë©”íƒ€ë°ì´í„°: `source: "self_learning"`, `type: "qa_pair"`

**ëª©ì **: ìœ ì‚¬ ì§ˆë¬¸ì´ ë‹¤ì‹œ ë“¤ì–´ì˜¬ ë•Œ ë” ë‚˜ì€ ë‹µë³€ ì œê³µ

#### 10ë‹¨ê³„: ì‘ë‹µ ë°˜í™˜ ë° í”„ë¡ íŠ¸ì—”ë“œ ì¶œë ¥

**ì‘ë‹µ í˜•ì‹**:
```json
{
    "answer": "ë‹µë³€ í…ìŠ¤íŠ¸",
    "used_chunks": ["ì¶œì²˜: ì²­í¬ ë¯¸ë¦¬ë³´ê¸°..."],
    "mode": "adler" | "counseling" | "general" | "llm_only",
    "continue_conversation": true,
    "similarity_score": 0.75,
    "search_iterations": 2
}
```

**í”„ë¡ íŠ¸ì—”ë“œ ì¶œë ¥**:
- `chatPanel.js`ì˜ `addTherapyMessage()` í•¨ìˆ˜
- ì•„ë“¤ëŸ¬ ì•„ì´ì½˜(ğŸ­)ê³¼ í•¨ê»˜ ë©”ì‹œì§€ í‘œì‹œ
- íŠ¹ë³„í•œ ìŠ¤íƒ€ì¼ë§ ì ìš© (therapy-bubble)

---

## ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ì„¤ëª…

### 1. RAGTherapySystem

**íŒŒì¼**: `backend/councel/sourcecode/persona/rag_therapy.py`

**ì—­í• **: ì „ì²´ ìƒë‹´ í”„ë¡œì„¸ìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ë©”ì¸ í´ë˜ìŠ¤

**ì£¼ìš” ì†ì„±**:
- `client`: ChromaDB Client (Vector DB í´ë¼ì´ì–¸íŠ¸)
- `collection`: ChromaDB Collection ("vector_adler" ì»¬ë ‰ì…˜)
- `openai_client`: OpenAI Client (OpenAI API í´ë¼ì´ì–¸íŠ¸)
- `counseling_keywords`: ìƒë‹´ í‚¤ì›Œë“œ ëª©ë¡ (200+ ê°œ)
- `chat_history`: ëŒ€í™” íˆìŠ¤í† ë¦¬ (ìµœëŒ€ 10ê°œ)
- `persona_manager`: PersonaManager (í˜ë¥´ì†Œë‚˜ ê´€ë¦¬ì)
- `search_engine`: SearchEngine (ê²€ìƒ‰ ì—”ì§„)
- `response_generator`: ResponseGenerator (ë‹µë³€ ìƒì„±ê¸°)

**ì£¼ìš” ë©”ì„œë“œ**:
- `chat(user_input)`: ë©”ì¸ ìƒë‹´ í•¨ìˆ˜, ì „ì²´ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰
- `_save_qa_to_vectordb()`: Self-learning: Q&Aë¥¼ Vector DBì— ì €ì¥

### 2. PersonaManager

**íŒŒì¼**: `backend/councel/sourcecode/persona/persona_manager.py`

**ì—­í• **: ì•„ë“¤ëŸ¬ í˜ë¥´ì†Œë‚˜ ìƒì„± ë° ìºì‹±

**í˜ë¥´ì†Œë‚˜ ìƒì„± ë°©ì‹**:
1. **ê¸°ë³¸ í˜ë¥´ì†Œë‚˜** (ì¦‰ì‹œ ì‚¬ìš©)
   - í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ê¸°ë°˜
   - ë¹ ë¥¸ ì‹œì‘ì„ ìœ„í•œ ê¸°ë³¸ í˜ë¥´ì†Œë‚˜

2. **RAG í˜ë¥´ì†Œë‚˜** (ë°±ê·¸ë¼ìš´ë“œ ìƒì„±)
   - Vector DB ê²€ìƒ‰ + ì›¹ ê²€ìƒ‰
   - ë” ì •í™•í•˜ê³  ìƒì„¸í•œ í˜ë¥´ì†Œë‚˜
   - ìƒì„± ì™„ë£Œ í›„ ìë™ êµì²´

**ìºì‹± ë©”ì»¤ë‹ˆì¦˜**:
- ìºì‹œ íŒŒì¼: `backend/councel/cache/adler_persona_cache.json`
- ìœ íš¨ ê¸°ê°„: 24ì‹œê°„
- ë§Œë£Œ ì‹œ ìë™ ì¬ìƒì„±

### 3. SearchEngine

**íŒŒì¼**: `backend/councel/sourcecode/persona/search_engine.py`

**ì—­í• **: Vector DB ê²€ìƒ‰ ë° ìœ ì‚¬ë„ ê³„ì‚°

**ì£¼ìš” ê¸°ëŠ¥**:
1. **ì„ë² ë”© ìƒì„±**
   - ëª¨ë¸: `text-embedding-3-large`
   - ì‚¬ìš©ì ì…ë ¥ì„ ë²¡í„°ë¡œ ë³€í™˜

2. **í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰**
   - ë²¡í„° ê²€ìƒ‰ (ì½”ì‚¬ì¸ ìœ ì‚¬ë„)
   - ê°ì • í‚¤ì›Œë“œ ê°€ì¤‘ì¹˜ ì ìš© (ìµœëŒ€ +0.2)

3. **Multi-step ê²€ìƒ‰**
   - ì´ˆê¸° ê²€ìƒ‰ â†’ í’ˆì§ˆ í‰ê°€ â†’ ì¿¼ë¦¬ í™•ì¥ â†’ ì¬ê²€ìƒ‰
   - ìµœëŒ€ 2íšŒ ë°˜ë³µ

4. **Re-ranker**
   - LLM ê¸°ë°˜ ê´€ë ¨ì„± í‰ê°€
   - ê²€ìƒ‰ ê²°ê³¼ ì¬ì •ë ¬

5. **ì¿¼ë¦¬ í™•ì¥**
   - LLMì„ í†µí•œ ê´€ë ¨ ê²€ìƒ‰ì–´ ìƒì„±
   - ê°ì • ìƒíƒœ, ì•„ë“¤ëŸ¬ ê°œë…, ìœ ì‚¬ ìƒí™© ì¶”ì¶œ

### 4. ResponseGenerator

**íŒŒì¼**: `backend/councel/sourcecode/persona/response_generator.py`

**ì—­í• **: LLM ê¸°ë°˜ ë‹µë³€ ìƒì„±

**ì£¼ìš” ê¸°ëŠ¥**:
1. **ì…ë ¥ ë¶„ë¥˜**
   - "adler": ì•„ë“¤ëŸ¬ ê´€ë ¨ í‚¤ì›Œë“œ
   - "counseling": ìƒë‹´ ê´€ë ¨ í‚¤ì›Œë“œ
   - "general": ì¼ë°˜

2. **LLM ë‹¨ë… ë‹µë³€**
   - ìœ ì‚¬ë„ê°€ ë†’ì„ ë•Œ (â‰¥ 0.7)
   - RAG ì—†ì´ í˜ë¥´ì†Œë‚˜ë§Œ ì‚¬ìš©

3. **RAG ê¸°ë°˜ ë‹µë³€**
   - ìœ ì‚¬ë„ê°€ ë‚®ì„ ë•Œ (< 0.7)
   - ê²€ìƒ‰ëœ ì²­í¬ë¥¼ ì»¨í…ìŠ¤íŠ¸ë¡œ í™œìš©
   - 3ë‹¨ê³„ êµ¬ì¡° ê°•ì œ

**3ë‹¨ê³„ ë‹µë³€ êµ¬ì¡°**:
1. **ê°ì • ì¸ì •**: ì‚¬ìš©ìì˜ ê°ì •ì„ ìˆëŠ” ê·¸ëŒ€ë¡œ ì¸ì •
2. **ì•„ë“¤ëŸ¬ ê´€ì  ì¬í•´ì„**: ì—´ë“±ê°ì„ ì„±ì¥ ê¸°íšŒë¡œ, ëª©í‘œ ì§€í–¥ì  ê´€ì  ì œì‹œ
3. **ê²©ë ¤ ë° ì‹¤ì²œ ë°©ì•ˆ**: ë‚´ì  í˜ ë¯¿ìŒ, êµ¬ì²´ì  ì‹¤ì²œ ë°©í–¥ ì œì‹œ

### 5. TherapyService

**íŒŒì¼**: `backend/app/domain/therapy/service.py`

**ì—­í• **: ì„œë¹„ìŠ¤ ë ˆì´ì–´, ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬

**íŠ¹ì§•**:
- ì‹±ê¸€í†¤ íŒ¨í„´: í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë§Œ ì¡´ì¬
- ì§€ì—° ì´ˆê¸°í™”: ì²« ìš”ì²­ ì‹œ RAGTherapySystem ì´ˆê¸°í™”

### 6. SupervisorAgent

**íŒŒì¼**: `backend/multi_agent/supervisor.py`

**ì—­í• **: ì¤‘ì•™ Supervisor Agent, ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ì „ë¬¸ ì—ì´ì „íŠ¸ë¥¼ ì„ íƒí•˜ê³  ì¡°ìœ¨

**ì£¼ìš” ê¸°ëŠ¥**:
1. ì‚¬ìš©ì ì§ˆë¬¸ ë¶„ì„
2. í‚¤ì›Œë“œ ê¸°ë°˜ ì—ì´ì „íŠ¸ ì„ íƒ
3. LangGraph Agentë¥¼ í†µí•œ Tool í˜¸ì¶œ
4. ìµœì¢… ê²°ê³¼ë¥¼ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬

**ì—ì´ì „íŠ¸ ëª©ë¡**:
- chatbot_tool: ì¼ë°˜ ëŒ€í™”
- rag_tool: íšŒì‚¬ ë¬¸ì„œ ê²€ìƒ‰
- brainstorming_tool: ë¸Œë ˆì¸ìŠ¤í† ë°
- planner_tool: ì¼ì • ê´€ë¦¬
- report_tool: ë¦¬í¬íŠ¸ ìƒì„±
- therapy_tool: ì‹¬ë¦¬ ìƒë‹´

### 7. TherapyAgent

**íŒŒì¼**: `backend/multi_agent/agents/therapy_agent.py`

**ì—­í• **: ì‹¬ë¦¬ ìƒë‹´ ì—ì´ì „íŠ¸, ê¸°ì¡´ TherapyServiceë¥¼ í™œìš©

**ì£¼ìš” ê¸°ëŠ¥**:
1. TherapyService ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
2. TherapyService.chat() í˜¸ì¶œ
3. ì‘ë‹µ ë°˜í™˜

**Lazy Loading**: ì‹¤ì œ ì‚¬ìš© ì‹œì—ë§Œ TherapyService ë¡œë“œ

---

## íŒŒì¼ êµ¬ì¡° ë° ì—­í• 

### ë°±ì—”ë“œ ì„œë²„ ì‹œì‘

```
backend/app/
â”œâ”€â”€ main.py                          # FastAPI ì•±, ì„œë²„ ì‹œì‘ ì‹œ automatic_save í˜¸ì¶œ
â”‚   â””â”€â”€ lifespan í•¨ìˆ˜: ì„œë²„ ì‹œì‘ ì‹œ automatic_save() ì‹¤í–‰
â”‚
â””â”€â”€ api/v1/endpoints/
    â”œâ”€â”€ multi_agent.py                # Multi-Agent API ì—”ë“œí¬ì¸íŠ¸
    â”‚   â””â”€â”€ POST /api/v1/multi-agent/query
    â”‚
    â””â”€â”€ therapy.py                    # Therapy API ì—”ë“œí¬ì¸íŠ¸ (ë ˆê±°ì‹œ)
        â””â”€â”€ POST /api/v1/therapy/chat
```

### automatic_save í”„ë¡œì„¸ìŠ¤

```
backend/councel/sourcecode/
â”œâ”€â”€ automatic_save.py                 # ìë™ ì €ì¥ í†µí•© ê´€ë¦¬
â”‚   â””â”€â”€ AutomaticSaveManager í´ë˜ìŠ¤
â”‚
â””â”€â”€ automatic_save/
    â”œâ”€â”€ create_chunk_files.py        # Step 1: ì²­í¬ ìƒì„±
    â”œâ”€â”€ create_openai_embeddings.py  # Step 2: ì„ë² ë”© ìƒì„±
    â””â”€â”€ save_to_vectordb.py          # Step 3: Vector DB ì €ì¥
```

### Multi-Agent ì‹œìŠ¤í…œ

```
backend/multi_agent/
â”œâ”€â”€ supervisor.py                     # Supervisor Agent (ì¤‘ì•™ ì¡°ìœ¨ì)
â”‚   â””â”€â”€ SupervisorAgent í´ë˜ìŠ¤
â”‚
â”œâ”€â”€ tools/
â”‚   â””â”€â”€ agent_tools.py               # ê° ì—ì´ì „íŠ¸ë¥¼ Toolë¡œ ë˜í•‘
â”‚       â”œâ”€â”€ chatbot_tool
â”‚       â”œâ”€â”€ rag_tool
â”‚       â”œâ”€â”€ brainstorming_tool
â”‚       â”œâ”€â”€ planner_tool
â”‚       â”œâ”€â”€ report_tool
â”‚       â””â”€â”€ therapy_tool
â”‚
â””â”€â”€ agents/
    â”œâ”€â”€ chatbot_agent.py             # ì¼ë°˜ ëŒ€í™” ì—ì´ì „íŠ¸
    â”œâ”€â”€ rag_agent.py                # íšŒì‚¬ ë¬¸ì„œ ê²€ìƒ‰ ì—ì´ì „íŠ¸
    â”œâ”€â”€ brainstorming_agent.py     # ë¸Œë ˆì¸ìŠ¤í† ë° ì—ì´ì „íŠ¸
    â”œâ”€â”€ planner_agent.py            # ì¼ì • ê´€ë¦¬ ì—ì´ì „íŠ¸
    â”œâ”€â”€ report_agent.py             # ë¦¬í¬íŠ¸ ìƒì„± ì—ì´ì „íŠ¸
    â””â”€â”€ therapy_agent.py            # ì‹¬ë¦¬ ìƒë‹´ ì—ì´ì „íŠ¸
```

### Therapy ì„œë¹„ìŠ¤ ë ˆì´ì–´

```
backend/app/domain/therapy/
â””â”€â”€ service.py                       # TherapyService (ì„œë¹„ìŠ¤ ë ˆì´ì–´)
    â””â”€â”€ ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ RAGTherapySystem ê´€ë¦¬
```

### RAG Therapy ì‹œìŠ¤í…œ

```
backend/councel/sourcecode/persona/
â”œâ”€â”€ rag_therapy.py                   # ë©”ì¸ ìƒë‹´ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ RAGTherapySystem í´ë˜ìŠ¤
â”‚
â”œâ”€â”€ persona_manager.py               # í˜ë¥´ì†Œë‚˜ ê´€ë¦¬
â”‚   â””â”€â”€ PersonaManager í´ë˜ìŠ¤
â”‚
â”œâ”€â”€ search_engine.py                  # ê²€ìƒ‰ ì—”ì§„
â”‚   â””â”€â”€ SearchEngine í´ë˜ìŠ¤
â”‚
â””â”€â”€ response_generator.py            # ë‹µë³€ ìƒì„±ê¸°
    â””â”€â”€ ResponseGenerator í´ë˜ìŠ¤
```

### í”„ë¡ íŠ¸ì—”ë“œ

```
renderer/chat/
â”œâ”€â”€ chatPanel.js                     # UI ë° ìƒíƒœ ê´€ë¦¬
â”‚   â”œâ”€â”€ handleSendMessage()
â”‚   â”œâ”€â”€ addMessage()
â”‚   â””â”€â”€ addTherapyMessage()
â”‚
â””â”€â”€ chatService.js                   # API í˜¸ì¶œ ë‹´ë‹¹
    â”œâ”€â”€ callChatModule()
    â””â”€â”€ getOrCreateMultiAgentSession()
```

### ë°ì´í„° ì €ì¥ ìœ„ì¹˜

```
backend/councel/
â”œâ”€â”€ vector_db/                       # ChromaDB ì €ì¥ ìœ„ì¹˜
â”‚   â””â”€â”€ vector_adler ì»¬ë ‰ì…˜
â”‚
â”œâ”€â”€ cache/
â”‚   â””â”€â”€ adler_persona_cache.json    # í˜ë¥´ì†Œë‚˜ ìºì‹œ
â”‚
â””â”€â”€ dataset/adler/
    â”œâ”€â”€ chunkfiles/                  # ì²­í¬ JSON íŒŒì¼ë“¤
    â””â”€â”€ embeddings/                  # ì„ë² ë”© JSON íŒŒì¼ë“¤
```

---

## ì£¼ìš” íŠ¹ì§•

### 1. Threshold ê¸°ë°˜ ë¶„ê¸°
- ìœ ì‚¬ë„ 0.7 ê¸°ì¤€ìœ¼ë¡œ LLM/RAG ì„ íƒ
- ë†’ì€ ìœ ì‚¬ë„: LLM ë‹¨ë… ë‹µë³€ (ë¹ ë¥¸ ì‘ë‹µ)
- ë‚®ì€ ìœ ì‚¬ë„: RAG + Self-learning (ì •í™•í•œ ë‹µë³€)

### 2. Multi-step ê²€ìƒ‰
- ì¿¼ë¦¬ í™•ì¥ì„ í†µí•œ ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ
- ìµœëŒ€ 2íšŒ ë°˜ë³µ ê²€ìƒ‰
- Re-rankerë¥¼ í†µí•œ ê²°ê³¼ ì¬ì •ë ¬

### 3. Self-learning
- ë‚®ì€ ìœ ì‚¬ë„ì¼ ë•Œ ìë™ í•™ìŠµ
- Q&Aë¥¼ Vector DBì— ì €ì¥
- ìœ ì‚¬ ì§ˆë¬¸ ì¬ë°œìƒ ì‹œ ë” ë‚˜ì€ ë‹µë³€ ì œê³µ

### 4. ë™ì  í˜ë¥´ì†Œë‚˜
- Vector DB + ì›¹ ê²€ìƒ‰ ê¸°ë°˜ ìƒì„±
- 24ì‹œê°„ ìºì‹±
- ë°±ê·¸ë¼ìš´ë“œì—ì„œ RAG í˜ë¥´ì†Œë‚˜ ìƒì„±

### 5. Multi-Agent ì•„í‚¤í…ì²˜
- Supervisor Agentê°€ ìë™ ë¼ìš°íŒ…
- ê° ì „ë¬¸ ì—ì´ì „íŠ¸ê°€ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘
- Lazy Loadingìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”

---

## ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ
- **FastAPI**: ì›¹ í”„ë ˆì„ì›Œí¬
- **ChromaDB**: Vector ë°ì´í„°ë² ì´ìŠ¤
- **OpenAI API**: LLM ë° ì„ë² ë”©
- **LangChain/LangGraph**: Multi-Agent í”„ë ˆì„ì›Œí¬
- **PyMuPDF**: PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ
- **tiktoken**: í† í° ìˆ˜ ê³„ì‚°

### í”„ë¡ íŠ¸ì—”ë“œ
- **JavaScript (ES6+)**: í”„ë¡œê·¸ë˜ë° ì–¸ì–´
- **Electron**: ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜
- **Fetch API**: HTTP í†µì‹ 

### LLM ë° ì„ë² ë”©
- **gpt-4o-mini**: ë‹µë³€ ìƒì„±, ë²ˆì—­, ì¿¼ë¦¬ í™•ì¥
- **text-embedding-3-large**: ì„ë² ë”© ìƒì„±

---

## ë°ì´í„° íë¦„ ìš”ì•½

```
ì„œë²„ ì‹œì‘
  â†“
automatic_save() ì‹¤í–‰
  â”œâ”€ PDF â†’ ì²­í¬ íŒŒì¼
  â”œâ”€ ì²­í¬ â†’ ì„ë² ë”© íŒŒì¼
  â””â”€ ì„ë² ë”© â†’ Vector DB
  â†“
ì‚¬ìš©ì ì…ë ¥
  â†“
Multi-Agent Supervisor
  â†“
Therapy Agent
  â†“
Therapy Service
  â†“
RAG Therapy System
  â”œâ”€ ê²€ìƒ‰ (Vector DB)
  â”œâ”€ ìœ ì‚¬ë„ ê³„ì‚°
  â”œâ”€ Threshold ë¶„ê¸°
  â”œâ”€ ë‹µë³€ ìƒì„±
  â””â”€ Self-learning (ì¡°ê±´ë¶€)
  â†“
ì‘ë‹µ ë°˜í™˜
  â†“
í”„ë¡ íŠ¸ì—”ë“œ ì¶œë ¥
```

---

**ë¬¸ì„œ ìƒì„±ì¼**: 2025.12.01  
**ìµœì¢… ìˆ˜ì •ì¼**: 2025.12.01

