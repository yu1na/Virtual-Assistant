<!-- μƒμ„±μΌ 2025.11.24 17:30 -->

# μ‹¬λ¦¬μƒλ‹΄ RAG μ‹μ¤ν… ν†µν•© μ™„λ£

## κµ¬ν„ λ‚΄μ©

### 1. λ°±μ—”λ“ μ„λ²„ μ‹μ‘ μ‹ Vector DB μλ™ μƒμ„±
- `backend/app/main.py`μ `lifespan` ν•¨μμ—μ„ `automatic_save()` νΈμ¶
- μ„λ²„ μ‹μ‘ μ‹ μλ™μΌλ΅ Vector DB μƒμ„± (μ΄λ―Έ μ΅΄μ¬ν•λ©΄ κ±΄λ„λ›°κΈ°)

### 2. μƒλ΅μ΄ μ‹¬λ¦¬μƒλ‹΄ μ—”λ“ν¬μΈνΈ
- **μ—”λ“ν¬μΈνΈ**: `POST /api/v1/therapy/chat`
- **μ”μ²­**: `{ "message": "μ‚¬μ©μ μ…λ ¥" }`
- **μ‘λ‹µ**: 
  ```json
  {
    "answer": "μƒλ‹΄μ‚¬ λ‹µλ³€",
    "mode": "adler/counseling/general",
    "used_chunks": ["μ°Έκ³  μλ£..."],
    "continue_conversation": true
  }
  ```

### 3. RAG μƒλ‹΄ μ„λΉ„μ¤ λ¨λ“
- `backend/app/domain/therapy/service.py` μƒμ„±
- `TherapyService` ν΄λμ¤ (μ‹±κΈ€ν†¤ ν¨ν„΄)
- `RAGTherapySystem` λν•‘

### 4. rag_therapy.py μμ •
- μ½μ†” μ¶λ ¥ μ κ±° (API μ‘λ‹µμ©μΌλ΅ λ³€κ²½)
- `is_therapy_related()` λ©”μ„λ“ μ¶”κ°€

### 5. ν”„λ΅ νΈμ—”λ“ ν†µν•©
- `renderer/chat/chatService.js`: μ‹¬λ¦¬ μƒλ‹΄ ν‚¤μ›λ“ κ°μ§€ λ° therapy API νΈμ¶
- `renderer/chat/chatPanel.js`: μ‹¬λ¦¬ μƒλ‹΄ λ©”μ‹μ§€ κµ¬λ¶„ ν‘μ‹
- `renderer/styles/chat.css`: μ•„λ“¤λ¬ νλ¥΄μ†λ‚ μ¤νƒ€μΌ μ¶”κ°€ (π­ μ•„μ΄μ½, νΉλ³„ν• λ°°κ²½μƒ‰)

## μ‚¬μ© λ°©λ²•

### λ°±μ—”λ“ μ„λ²„ μ‹μ‘
```bash
cd backend
uvicorn app.main:app --reload
```

### ν”„λ΅ νΈμ—”λ“μ—μ„ ν…μ¤νΈ
μ±„ν…μ°½μ— λ‹¤μκ³Ό κ°™μ€ λ©”μ‹μ§€ μ…λ ¥:
- "μ”μ¦ λ„λ¬΄ νλ“¤μ–΄"
- "μ¤νΈλ μ¤ λ°›μ•„"
- "μ•„λ“¤λ¬μ— λ€ν•΄ μ•λ ¤μ¤"
- "μ°μΈν•΄"
- "μ‹¬λ¦¬ μƒλ‹΄ ν•„μ”ν•΄"

β†’ μλ™μΌλ΅ μ•„λ“¤λ¬ νλ¥΄μ†λ‚ κΈ°λ° μ‹¬λ¦¬ μƒλ‹΄ μ‹μ¤ν…μΌλ΅ λΌμ°ν…λ¨

## μ‹¬λ¦¬ μƒλ‹΄ ν‚¤μ›λ“ λ©λ΅
```javascript
[
  'νλ“¤μ–΄', 'μƒλ‹΄', 'μ§μ¦', 'μ°μΈ', 'λ¶μ•', 'μ¤νΈλ μ¤',
  'κ³ λ―Ό', 'κ±±μ •', 'μ¬ν”„', 'μ™Έλ΅', 'ν™”λ‚', 'λ‹µλ‹µ',
  'μ•„λ“¤λ¬', 'adler', 'counseling', 'therapy', 'help',
  'depressed', 'anxious', 'μ‹¬λ¦¬'
]
```

## API ν…μ¤νΈ

### μƒλ‹΄ μ‹μ¤ν… μƒνƒ ν™•μΈ
```bash
curl http://localhost:8000/api/v1/therapy/status
```

### μ‹¬λ¦¬ μƒλ‹΄ λ©”μ‹μ§€ μ „μ†΅
```bash
curl -X POST http://localhost:8000/api/v1/therapy/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "μ”μ¦ λ„λ¬΄ νλ“¤μ–΄μ”"}'
```

## μ£Όμ” νΉμ§•

1. **μλ™ Vector DB μƒμ„±**: μ„λ²„ μ‹μ‘ μ‹ μλ™μΌλ΅ Vector DB μƒμ„±
2. **ν‚¤μ›λ“ κΈ°λ° μλ™ λΌμ°ν…**: μ‹¬λ¦¬ μƒλ‹΄ κ΄€λ ¨ ν‚¤μ›λ“ κ°μ§€ μ‹ μλ™μΌλ΅ therapy API νΈμ¶
3. **μ•„λ“¤λ¬ νλ¥΄μ†λ‚**: μ•„λ“¤λ¬ κ°μΈμ‹¬λ¦¬ν•™ κΈ°λ° μƒλ‹΄ μ‘λ‹µ
4. **μ‹κ°μ  κµ¬λ¶„**: ν”„λ΅ νΈμ—”λ“μ—μ„ μ‹¬λ¦¬ μƒλ‹΄ λ©”μ‹μ§€λ¥Ό νΉλ³„ν• μ¤νƒ€μΌλ΅ ν‘μ‹
5. **λ‹¤κµ­μ–΄ μ§€μ›**: ν•κµ­μ–΄ μ…λ ¥μ„ μμ–΄λ΅ λ²μ—­ν•μ—¬ Vector DB κ²€μƒ‰

## νμΌ κµ¬μ΅°

```
backend/
β”β”€β”€ app/
β”‚   β”β”€β”€ main.py (automatic_save ν†µν•©)
β”‚   β”β”€β”€ api/v1/
β”‚   β”‚   β”β”€β”€ router.py (therapy λΌμ°ν„° λ“±λ΅)
β”‚   β”‚   β””β”€β”€ endpoints/
β”‚   β”‚       β””β”€β”€ therapy.py (μƒλ΅ μƒμ„±)
β”‚   β””β”€β”€ domain/
β”‚       β””β”€β”€ therapy/
β”‚           β”β”€β”€ __init__.py (μƒλ΅ μƒμ„±)
β”‚           β””β”€β”€ service.py (μƒλ΅ μƒμ„±)
β””β”€β”€ councel/
    β””β”€β”€ sourcecode/
        β”β”€β”€ automatic_save.py
        β””β”€β”€ persona/
            β””β”€β”€ rag_therapy.py (μμ •)

renderer/
β”β”€β”€ chat/
β”‚   β”β”€β”€ chatService.js (therapy API νΈμ¶ μ¶”κ°€)
β”‚   β””β”€β”€ chatPanel.js (therapy λ©”μ‹μ§€ ν‘μ‹ μ¶”κ°€)
β””β”€β”€ styles/
    β””β”€β”€ chat.css (therapy μ¤νƒ€μΌ μ¶”κ°€)
```

## μ™„λ£ μ‚¬ν•­
- β… therapy λ„λ©”μΈ λ””λ ‰ν† λ¦¬ λ° μ„λΉ„μ¤ νμΌ μƒμ„±
- β… rag_therapy.pyμ μ½μ†” μ¶λ ¥ μ κ±° λ° APIμ©μΌλ΅ μμ •
- β… therapy.py μ—”λ“ν¬μΈνΈ μƒμ„± λ° λΌμ°ν„° λ“±λ΅
- β… main.py lifespanμ— automatic_save() ν†µν•©
- β… ν”„λ΅ νΈμ—”λ“μ— μ•„λ“¤λ¬ νλ¥΄μ†λ‚ μ¤νƒ€μΌ μ¶”κ°€

